(this["webpackJsonpra-example-oauth"]=this["webpackJsonpra-example-oauth"]||[]).push([[0],{323:function(e,t,n){e.exports=n(489)},328:function(e,t,n){},489:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),a=n(13),i=n.n(a),c=(n(328),n(562)),s=n(559),u=n(561),l=n(33),d=n(124),f=n(73),h=n(62),g=n(152),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.a.fetchJson,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Headers({"Content-Type":"application/json"});return{getList:function(o,r){var a=r.pagination,i=a.page,c=a.perPage,s=r.sort,u=s.field,l=s.order,d={sort:JSON.stringify([u,l]),range:JSON.stringify([(i-1)*c,i*c-1]),filter:JSON.stringify(r.filter)},f="".concat(e,"/").concat(o,"?").concat(Object(h.stringify)(d));return t(f,{headers:n}).then((function(e){var t=e.headers,n=e.json;if(!t.has("content-range"))throw new Error("The Content-Range header is missing in the HTTP Response. The simple REST data provider expects responses for lists of resources to contain this header with the total number of results to build the pagination. If you are using CORS, did you declare Content-Range in the Access-Control-Expose-Headers header?");return{data:n.data,total:parseInt(t.get("content-range").split("/").pop(),10)}}))},getOne:function(n,o){return t("".concat(e,"/").concat(n,"/").concat(o.id)).then((function(e){return{data:e.json}}))},getMany:function(o,r){var a={filter:JSON.stringify({id:r.ids})},i="".concat(e,"/").concat(o,"?").concat(Object(h.stringify)(a));return t(i,{headers:n}).then((function(e){return{data:e.json}}))},getManyReference:function(o,r){var a=r.pagination,i=a.page,c=a.perPage,s=r.sort,u=s.field,l=s.order,g={sort:JSON.stringify([u,l]),range:JSON.stringify([(i-1)*c,i*c-1]),filter:JSON.stringify(Object(f.a)(Object(f.a)({},r.filter),{},Object(d.a)({},r.target,r.id)))},p="".concat(e,"/").concat(o,"?").concat(Object(h.stringify)(g));return t(p,{headers:n}).then((function(e){var t=e.headers,n=e.json;if(!t.has("content-range"))throw new Error("The Content-Range header is missing in the HTTP Response. The simple REST data provider expects responses for lists of resources to contain this header with the total number of results to build the pagination. If you are using CORS, did you declare Content-Range in the Access-Control-Expose-Headers header?");return{data:n,total:parseInt(t.get("content-range").split("/").pop(),10)}}))},update:function(o,r){return t("".concat(e,"/").concat(o,"/").concat(r.id),{method:"PUT",headers:n,body:JSON.stringify(r.data)}).then((function(e){return{data:e.json}}))},updateMany:function(o,r){return Promise.all(r.ids.map((function(a){return t("".concat(e,"/").concat(o,"/").concat(a),{method:"PUT",headers:n,body:JSON.stringify(r.data)})}))).then((function(e){return{data:e.map((function(e){return e.json.id}))}}))},create:function(o,r){return t("".concat(e,"/").concat(o),{method:"POST",headers:n,body:JSON.stringify(r.data)}).then((function(e){var t=e.json;return{data:Object(f.a)(Object(f.a)({},r.data),{},{id:t.id})}}))},delete:function(o,r){return t("".concat(e,"/").concat(o,"/").concat(r.id),{method:"DELETE",headers:n}).then((function(e){return{data:e.json}}))},deleteMany:function(o,r){return Promise.all(r.ids.map((function(r){return t("".concat(e,"/").concat(o,"/").concat(r),{method:"DELETE",headers:n})}))).then((function(e){return{data:e.map((function(e){return e.json.id}))}}))}}},m=n(175),v=n.n(m),w=n(246),b=n(247),y=n(248),O=n.n(y),j="http://localhost:8080",S=new b.UserManager({authority:"https://accounts.google.com/",client_id:"854104656823-f65tg15edrl33dcqhnm55ttkj2tcajos.apps.googleusercontent.com",redirect_uri:"https://localhost:3000/login",response_type:"code",scope:"openid email profile"}),E={login:function(){var e=Object(w.a)(v.a.mark((function e(){var t,n,o,r,a,i,c=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=c.length>0&&void 0!==c[0]?c[0]:{})&&t.code&&t.state){e.next=4;break}return S.signinRedirect(),e.abrupt("return",Promise.reject({message:"Retrieving code from authentication service.",code:"oauthRedirect"}));case 4:return S.clearStaleState(),n="oidc.".concat(t.state),o=JSON.parse(localStorage.getItem(n)||"{}"),r=o.code_verifier,e.next=9,O()({method:"POST",url:"".concat(j,"/auth"),data:{code:t.code,code_verifier:r},responseType:"json",headers:{Authorization:"Bearer ".concat(t.code)}});case 9:return a=e.sent,i=a.data,localStorage.setItem("token",JSON.stringify(i)),e.abrupt("return",Promise.resolve());case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),logout:function(){return localStorage.removeItem("token"),Promise.resolve()},checkError:function(e){var t=e.status;return!t||401!==t&&403!==t?Promise.resolve():(localStorage.clear(),Promise.reject())},checkAuth:function(e){var t=localStorage.getItem("token");if(!t)return Promise.reject();var n=function(e){var t=JSON.parse(e),n=JSON.parse(window.atob(t.id_token.split(".")[1]));return Object(f.a)({id:"my-profile"},n)}(t);return(new Date).getTime()>1e3*n.exp?Promise.reject():Promise.resolve()},getPermissions:function(e){var t=localStorage.getItem("token");return t?Promise.resolve(t):Promise.reject()}},P=n(563),T=n(287),k=n(289),R=n(541),N=n(44),J=n(539),x=n(542),C=n(543),I=n(544),L=Object(J.a)((function(e){return{button:{width:"100%"},icon:{marginRight:e.spacing(1)}}}),{name:"RaLoginButton"});function A(e){e.redirectTo;var t=Object(k.a)(e,["redirectTo"]),n=L(),a=Object(R.a)(),i=Object(N.a)(!1),c=Object(T.a)(i,2),s=c[0],u=c[1],l=function(e,t){u(!0),a({code:e,state:t}).catch((function(e){}))};return Object(o.useEffect)((function(){var e=new URL(window.location.href).searchParams,t=e.get("code"),n=e.get("state");t&&n&&l(t,n)}),[]),r.a.createElement(x.a,null,r.a.createElement(C.a,Object.assign({},t,{onClick:l,variant:"contained",color:"primary",disabled:s,className:n.button}),s&&r.a.createElement(I.a,{className:n.icon,size:18,thickness:2}),"Logging in with Google"))}A.defaultProps={redirectTo:"/"};var W=A,_=function(){return r.a.createElement(P.a,null,r.a.createElement(W,null))},H=n(546),M=n(552),U=n(551),B=function(){return r.a.createElement(H.a,null,r.a.createElement(U.a,{title:"Welcome to React Admin"}),r.a.createElement(M.a,null,"From this application you will be able to interact with Google OAuth."))},D=Object(l.a)(),z=function(){return r.a.createElement(c.a,{dataProvider:p("http://localhost:8080"),authProvider:E,history:D,loginPage:_,dashboard:B},r.a.createElement(s.a,{name:"resource",list:u.a}))},G=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function q(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(r.a.createElement(z,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");G?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):q(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):q(e)}))}}()}},[[323,1,2]]]);
//# sourceMappingURL=main.6040b76a.chunk.js.map